<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="default :: header"></head>

<body onload="initMap(), moveToLocation()">
	<nav th:replace="default :: bar"></nav>
	<div class="container">
		<div th:if="${prepaidQR} != null" id="idMainContent"
			class="container-fluid">
			<div id="detaillsDiv" class="transparency" style="padding:15px;">
				<h4>
					<span class="badge badge-lg badge-danger" th:text="${prepaidQR.id}"
						id="id"></span>
				</h4>
				<p th:if="${prepaidQR.userName} != null"
					th:utext="'<strong style=color:coral>Usuario asignado:</strong> ' + ${prepaidQR.userName}"></p>
				<br>
				<h5>
					<i class="fas fa-paw" style="color:pink"></i> Datos básicos
				</h5>
				<hr>
				<img th:if="${prepaidQR.resultBase64Avatar == null}" alt="" src="../img/withoutPhoto.png" class="img-thumbnail" style="width:150px; height:150px;" />
				<img th:unless="${prepaidQR.resultBase64Avatar == null}" th:src="${prepaidQR.resultBase64Avatar}" style="box-shadow: 0px 0px 15px black; border-radius: 7px;" class="img-thumbnail"/>
				
				<p th:if="${prepaidQR.owner.residence} != null"
					th:utext="'<strong style=color:coral>País:</strong> ' + ${prepaidQR.owner.residence}"></p>
				<p th:if="${prepaidQR.pet.petName} != null"
					th:utext="'<strong style=color:coral>Nombre:</strong> ' + ${prepaidQR.pet.petName}"></p>
				<p th:if="${prepaidQR.pet.age} <= 2018"
					th:utext="'<strong style=color:coral>Nacimimento:</strong> ' + ${prepaidQR.pet.age}"></p>
				<p th:if="${prepaidQR.pet.sex} != null"
					th:utext="'<strong style=color:coral>Sexo:</strong> ' + ${prepaidQR.pet.sex}"></p>

				<br>
				<h5>
					<i class="fas fa-heartbeat" style="color:red"></i> Estado de salud
				</h5>
				<hr>
				<p th:if="${prepaidQR.pet.clinicHistory} != null"
					th:utext="'<strong style=color:coral>Historia Clínica:</strong> ' + ${prepaidQR.pet.clinicHistory}"></p>
				<p th:if="${prepaidQR.pet.illness} != null"
					th:utext="'<strong style=color:coral>Enfermedades:</strong> ' + ${prepaidQR.pet.illness}"></p>

				<p th:if="${prepaidQR.pet.medicated} == true"><strong style="color:coral">Medicado:</strong> Sí</p>
				<p th:unless="${prepaidQR.pet.medicated} == true"
					th:utext="'<strong style=color:coral>Medicado:</strong> ' + ${prepaidQR.pet.medicated}">Medicado:
					No</p>


				<table class="table table-dark table-bordered table-responsive">
					<thead>
						<tr>
							<td>V. Antirábica</td>
							<td>V. Polivalente</td>
							<td>V. Sextuple</td>
							<td>V. Octuple</td>
						</tr>
						<tr>
							<td><p th:if="${prepaidQR.pet.medicated} != null"
									th:text="${prepaidQR.pet.dateAntiRabicVaccine}"></p></td>
							<td><p th:if="${prepaidQR.pet.medicated} != null"
									th:text="${prepaidQR.pet.datePolivalentVaccine}"></p></td>
							<td><p th:if="${prepaidQR.pet.medicated} != null"
									th:text="${prepaidQR.pet.dateSextupleVaccine}"></p></td>
							<td><p th:if="${prepaidQR.pet.medicated} != null"
									th:text="${prepaidQR.pet.dateOctupleVaccine}"></p></td>
						</tr>
					</thead>
				</table>
				<br>
				<p th:if="${prepaidQR.pet.lastVeterinaryVisit} != null"
					th:utext="'<strong style=color:coral>Últ.visita veterinaria:</strong> ' + ${prepaidQR.pet.lastVeterinaryVisit}"></p>

				<p th:if="${prepaidQR.pet.neuteredPet} == true"><strong style="color:coral">Castrado:</strong> Sí</p>
				<p th:unless="${prepaidQR.pet.neuteredPet} == true"><strong style=color:coral>Castrado:</strong> No</p>

				<p th:if="${prepaidQR.pet.pregnant} == true"><strong style=color:coral>Preñiada:</strong> Sí</p>
				<p th:unless="${prepaidQR.pet.pregnant} == true"><strong style=color:coral>Preñiada:</strong> No</p>

				<br>

				<h5>
					<i class="fas fa-fish" style="color:lightblue"></i> Alimentación
				</h5>
				<hr>
				<p th:if="${prepaidQR.pet.foodBrand} != null"
					th:utext="'<strong style=color:coral>Marca de Comida bal:</strong> ' + ${prepaidQR.pet.foodBrand}"></p>
				<p th:if="${prepaidQR.pet.quantityFood} != null"
					th:utext="'<strong style=color:coral>Cantidad comida Balanceada:</strong> ' + ${prepaidQR.pet.quantityFood} + ' gr'"></p>
				<p th:if="${prepaidQR.pet.coockedFood} != null"
					th:utext="'<strong style=color:coral>Comida húmeda:</strong> ' + ${prepaidQR.pet.coockedFood}"></p>
				<br>
				<h5>
					<i class="fas fa-paw" style="color:pink"></i> Estado
				</h5>
				<hr>
				<p th:if="${prepaidQR.pet.status} != false"><strong style=color:coral>Normal</strong></p>
				<p th:unless="${prepaidQR.pet.status} != false"
					style="color: deeppink;">Perdido!!!, contáctese con los tutores
					por favor.</p>
				<br>
				<h5>
					<i class="fas fa-user" style="color:lightgreen"></i> Datos de contacto
				</h5>
				<hr>
				<p th:if="${prepaidQR.owner.ownerName} != null"
					th:utext="'<strong style=color:coral>Tutor:</strong> ' + ${prepaidQR.owner.ownerName} + ' ' + ${prepaidQR.owner.ownerLastname}"></p>
				<p th:if="${prepaidQR.owner.dni} != null"
					th:utext="'<strong style=color:coral>Dni:</strong> ' + ${prepaidQR.owner.dni}"></p>
				<p th:if="${prepaidQR.owner.telephone1} != null"
					th:utext="'<strong style=color:coral>Teléfono:</strong> ' + ${prepaidQR.owner.telephone1}"></p>
				<p th:if="${prepaidQR.owner.telephone2} != null"
					th:utext="'<strong style=color:coral>Teléfono:</strong> ' + ${prepaidQR.owner.telephone2}"></p>
				<p th:if="${prepaidQR.owner.email} != null"
					th:text="${prepaidQR.owner.email}" id="mail" style="color:LimeGreen"></p>
				<p th:if="${prepaidQR.owner.address} != null"
					th:utext="'<strong style=color:coral>Dirección:</strong> ' + ${prepaidQR.owner.address}"></p>
				<p th:if="${prepaidQR.owner.facebook} != null"
					th:utext="'<strong style=color:coral>Facebook:</strong> ' + ${prepaidQR.owner.facebook}"></p>
				<p th:if="${prepaidQR.owner.instagram} != null"
					th:utext="'<strong style=color:coral>Instagram:</strong> ' + ${prepaidQR.owner.instagram}"></p>
				<input type="hidden" th:value="${prepaidQR.strBase64}"
					id="strBase64"></input> <br>


			<h5>Mapas</h5>
			<hr>
			<!-- Map Start -->
			<p>Dirección declarada donde reside la mascota</p> 
			<div id="testcanvas">
			<input type="hidden" th:value="${prepaidQR.owner.latitude}" id="latitude"/>
			<input type="hidden" th:value="${prepaidQR.owner.longitude}" id="longitude"/>
				<div id="map" class="container-fluid"></div>
			</div>
			
<!-- 			<button onclick="takeScreenShoot()">Screenshoot</button> -->
<!-- 			<br> -->
<!-- 			<br> -->
<!-- 			<img id="put" src="" alt=""> -->
			
			<!-- Map End -->

			</div>
			
			<script>
			function takeScreenShoot(){
				html2canvas($("#testcanvas"), {
					useCORS: true,
				        optimized: false,
				        allowTaint: false,
				        onrendered: function(canvas) {
				            // canvas is the final rendered <canvas> element
				            var myImage = canvas.toDataURL("image/jpeg");
				   //         window.open(myImage);
				   document.getElementById("put").src= myImage;
				        }
				    });
				
			}
			
			
			</script>
			<script>
			/* Needs to be here to wait charge email input, not onload */
			$( document ).ready(function() {
				getLocalization();
			});
			</script>
			
			<br> <br> <br>
		</div>
	</div>
	<footer th:replace="default :: footer"></footer>
</body>

</html>