<html xmlns:th="http://www.thymeleaf.org">

<head>
	<div th:include="default :: header"></div>
	<link rel="stylesheet" type="text/css" href="../css/id.css" />
	<link rel="stylesheet" type="text/css" href="../css/maps.css" />
</head>

<body onload="initMap(), moveToLocation(), youtube_parser()">
	<nav th:replace="default :: bar"></nav>
	<div class="container">
		<div th:if="${prepaidQR} != null" id="idMainContent"
			class="container-fluid">
			
			
			<div id="detaillsDiv" class="transparency" style="padding:15px;">
				<h4>
					<span class="badge badge-lg badge-danger" th:text="${prepaidQR.id}"
						id="id"></span>
				</h4>
				<p th:if="${prepaidQR.userName} != null">
					<strong style="color:coral" th:text="#{id.assignedusername}">Usuario asignado: </strong><span th:text="${prepaidQR.userName}"></span></p>
				<br>
				<h5>
					<i class="fas fa-paw" style="color:pink"></i> <span th:text="#{id.basicinfo}">Datos básicos</span>
				</h5>
				<hr>
				<img th:if="${prepaidQR.resultBase64Avatar == null}" alt="" src="../img/withoutPhoto.png" class="img-thumbnail" style="width:150px; height:150px;" />
				<img th:unless="${prepaidQR.resultBase64Avatar == null}" th:src="${prepaidQR.resultBase64Avatar}" style="box-shadow: 0px 0px 15px black; border-radius: 7px;" class="img-thumbnail"/>
				
				<p th:if="${prepaidQR.owner.residence} != null">
					<strong style="color:coral" th:text="#{id.country}">País:</strong> <span th:text="${prepaidQR.owner.residence}"></span></p>
				<p th:if="${prepaidQR.pet.petName} != null">
					<strong style="color:coral" th:text="#{id.petname}">Nombre:</strong> <span th:text="${prepaidQR.pet.petName}"></span></p>
				<p th:if="${prepaidQR.pet.age} <= 2018">
					<strong style="color:coral" th:text="#{id.birthday}">Nacimimento:</strong> <span th:text="${prepaidQR.pet.age}"></span></p>
				<p th:if="${prepaidQR.pet.sex} != null">
					<strong style="color:coral" th:text="#{id.sex}">Sexo:</strong> <span th:text="${prepaidQR.pet.sex}"></span></p>

				<br>
				<h5>
					<i class="fas fa-heartbeat" style="color:red"></i> <span th:text="#{id.health.title}">Estado de salud</span>
				</h5>
				<hr>
				<p th:if="${prepaidQR.pet.clinicHistory} != null">
					<strong style="color:coral" th:text="#{id.hc}">Historia Clínica:</strong> <span th:text="${prepaidQR.pet.clinicHistory}"></span></p>
				<p th:if="${prepaidQR.pet.illness} != null">
					<strong style="color:coral" th:text="#{id.illness}">Enfermedades:</strong> <span th:text="${prepaidQR.pet.illness}"></span></p>

				<p th:if="${prepaidQR.pet.medicated} == true"><strong style="color:coral" th:text="#{id.medicated}">Medicado:</strong> Sí</p>
				<p th:unless="${prepaidQR.pet.medicated} == true">
					<strong style="color:coral" th:text="#{id.medicated}">Medicado:</strong> No</p>


				<table class="table table-dark table-bordered table-responsive">
					<thead>
						<tr>
							<td th:text="#{id.vaccineantirabic}">V. Antirábica</td>
							<td th:text="#{id.vaccinepolivalent}">V. Polivalente</td>
							<td th:text="#{id.vaccinesextuple}">V. Sextuple</td>
							<td th:text="#{id.vaccineoctuple}">V. Octuple</td>
						</tr>
						<tr>
							<td><p th:if="${prepaidQR.pet.medicated} != null"
									th:text="${prepaidQR.pet.dateAntiRabicVaccine}"></p></td>
							<td><p th:if="${prepaidQR.pet.medicated} != null"
									th:text="${prepaidQR.pet.datePolivalentVaccine}"></p></td>
							<td><p th:if="${prepaidQR.pet.medicated} != null"
									th:text="${prepaidQR.pet.dateSextupleVaccine}"></p></td>
							<td><p th:if="${prepaidQR.pet.medicated} != null"
									th:text="${prepaidQR.pet.dateOctupleVaccine}"></p></td>
						</tr>
					</thead>
				</table>
				<br>
				<p th:if="${prepaidQR.pet.lastVeterinaryVisit} != null">
					<strong style="color:coral" th:text="#{id.lastveterinaryvisit}">Últ.visita veterinaria:</strong> <span th:text="${prepaidQR.pet.lastVeterinaryVisit}"></span></p>

				<p th:if="${prepaidQR.pet.neuteredPet} == true"><strong style="color:coral" th:text="#{id.neuteredpet}">Castrado:</strong> Sí</p>
				<p th:unless="${prepaidQR.pet.neuteredPet} == true"><strong style="color:coral" th:text="#{id.neuteredpet}">Castrado:</strong> No</p>

				<p th:if="${prepaidQR.pet.pregnant} == true"><strong style=color:coral th:text="#{id.pregnant}">Preñiada:</strong> Sí</p>
				<p th:unless="${prepaidQR.pet.pregnant} == true"><strong style="color:coral" th:text="#{id.pregnant}">Preñiada:</strong> No</p>

				<br>

				<h5>
					<i class="fas fa-fish" style="color:lightblue"></i> <span th:text="#{id.food.title}">Alimentación</span>
				</h5>
				<hr>
				<p th:if="${prepaidQR.pet.foodBrand} != null">
					<strong style="color:coral" th:text="#{id.brandfood}">Marca de Comida bal:</strong> <span th:text="${prepaidQR.pet.foodBrand}"></span></p>
				<p th:if="${prepaidQR.pet.quantityFood} != null">
					<strong style="color:coral" th:text="#{id.quantityfood}">Cantidad comida Balanceada:</strong> <span th:text="${prepaidQR.pet.quantityFood}"></span> gr</p>
				<p th:if="${prepaidQR.pet.coockedFood} != null">
					<strong style="color:coral" th:text="#{id.freshfood}">Comida húmeda:</strong> <span th:text="${prepaidQR.pet.coockedFood}"></span></p>
				<br>
				<h5>
					<i class="fas fa-paw" style="color:pink"></i> <span th:text="#{id.status.title}">Estado</span>
				</h5>
				<hr>
				<p th:if="${prepaidQR.pet.status} != false"><strong style="color:coral" th:text="#{id.status.normal}">Normal</strong></p>
				<p th:unless="${prepaidQR.pet.status} != false"
					style="color: deeppink;" th:text="#{id.status.lost}">Perdido!!!, contáctese con los tutores
					por favor.</p>
				<br>
				<h5>
					<i class="fas fa-user" style="color:lightgreen"></i> <span th:text="#{id.owner.title}">Datos de contacto</span>
				</h5>
				<hr>
				<p th:if="${prepaidQR.owner.ownerName} != null">
					<strong style="color:coral" th:text="#{id.ownername}">Tutor:</strong> <span th:text="${prepaidQR.owner.ownerName}"></span> <span th:text="${prepaidQR.owner.ownerLastname}"></span></p>
				<p th:if="${prepaidQR.owner.dni} != null">
					<strong style="color:coral" th:text="#{id.idlegalnumber}">Dni:</strong> <span th:text="${prepaidQR.owner.dni}"></span></p>
				<p th:if="${prepaidQR.owner.telephone1} != null">
					<strong style="color:coral" th:text="#{id.phone1}">Teléfono:</strong> <span th:text="${prepaidQR.owner.telephone1}"></span></p>
				<p th:if="${prepaidQR.owner.telephone2} != null">
					<strong style="color:coral" th:text="#{id.phone2}">Teléfono:</strong> <span th:text="${prepaidQR.owner.telephone2}"></span></p>
				<p th:if="${prepaidQR.owner.email} != null">
					<strong style="color:coral" th:text="#{id.email}">Email:</strong> <span th:text="${prepaidQR.owner.email}" id="mail" style="color:LimeGreen"></span></p>
				<p th:if="${prepaidQR.owner.address} != null">
					<strong style="color:coral" th:text="#{id.address}">Dirección:</strong> <span th:text="${prepaidQR.owner.address}"></span></p>
				<p th:if="${prepaidQR.owner.facebook} != null">
					<strong style="color:coral" th:text="#{id.facebook}">Facebook:</strong> <span th:text="${prepaidQR.owner.facebook}"></span></p>
				<p th:if="${prepaidQR.owner.instagram} != null">
					<strong style="color:coral" th:text="#{id.instagram}">Instagram:</strong> <span th:text="${prepaidQR.owner.instagram}"></span></p>
				<input type="hidden" th:value="${prepaidQR.strBase64}"
					id="strBase64"></input> <br>

			<h5>Video</h5>
			<hr>
			<iframe th:if="${prepaidQR.pet.videoUrl != null} and ${prepaidQR.pet.videoUrl != ''}" id="iframeYoutube" width="420" height="315" src="">
			</iframe>
			<p th:unless="${prepaidQR.pet.videoUrl != null} and ${prepaidQR.pet.videoUrl != ''}">No hay Video para mostrar</p>
<br>			
			
<script th:inline="javascript">
/* Parser Videos Youtube take care from this code */
function youtube_parser(){
		setTimeout(function(){
						var url = [[${prepaidQR.pet.videoUrl}]];
						var iframe = document.getElementById("iframeYoutube");
						var regExp = /^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/;
						var match = url.match(regExp);
						if (match && match[7].length == 11){
						    var b = match[7];
						    alert("https://www.youtube.com/embed/"+b)
						    iframe.src = "https://www.youtube.com/embed/"+b;
						}else{
						    console.log("Incorrect URL or a conecction problem with Youtube");
						}
	
	}, 2000);

}
</script>


			<h5>Mapas</h5>
			<hr>
			<!-- Map Start -->
			<p>Dirección declarada donde reside la mascota</p> 
			<div id="testcanvas">
			<input type="hidden" th:value="${prepaidQR.owner.latitude}" id="latitude"/>
			<input type="hidden" th:value="${prepaidQR.owner.longitude}" id="longitude"/>
				<div id="map" class="container-fluid" ></div>
			</div>
			<!-- Map End -->

			</div>
			
			<script>
			/* Needs to be here to wait charge email input, not onload */
			$( document ).ready(function() {
				getLocalization();
			});
			</script>
			
			<br> <br> <br>
		</div>
	</div>
	
		<!-- Start Google Maps Javascript -->
		<script type="text/javascript" src="../js/googleApis.js"></script>
		<!-- Javascript maps libraries -->
		<script
			src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDFuQb3h_4AhG3Kmdf3NIz3aZfzsguDQOE&libraries=places&callback=initMap"
			async defer></script>
		<!-- Javascript maps libraries -->
	
	<footer th:replace="default :: footer"></footer>
</body>

</html>